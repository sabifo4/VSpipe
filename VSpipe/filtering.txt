#!/bin/bash
#$ -S /bin/bash
#$ -cwd             # Job will run from the current directory
#$ -V               # Job will inherit current environment settings
#each time this is executed a filtering of the results of a specified result directory is done
cnt=-1
while read line
do
	cnt=$(( cnt+1 ))
        lines[$cnt]=$line
done < variables.txt
#variables that the user put in the beginning of the execution of the pipeline
res_dir=${lines[8]}

if [[ ${lines[11]} == 'nothing' ]]
then
	filt_dir=${lines[12]}

	ord_ch=${lines[13]}

	filt_ch=${lines[14]}

else
	filt_dir=${lines[13]}

	ord_ch=${lines[14]}

	filt_ch=${lines[15]}

fi
path_other_files='/mnt/iusers01/pb01/genome_analysis/pidock/'
mkdir $res_dir/'filtered_results'/$filt_dir
cp $res_dir/"output.csv" $res_dir/'filtered_results'/$filt_dir
cp $res_dir/"output.txt" $res_dir/'filtered_results'/$filt_dir
cp -r $res_dir/'lowest_energy_pdb' $res_dir/'filtered_results'/$filt_dir
python $path_other_files'filtering.py' $res_dir/'filtered_results'/$filt_dir/ $ord_ch $filt_ch 1
